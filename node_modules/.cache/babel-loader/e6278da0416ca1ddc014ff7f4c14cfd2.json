{"remainingRequest":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\src\\components\\Mis.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\src\\components\\Mis.vue","mtime":1607940281580},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1607075055352},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\babel-loader\\lib\\index.js","mtime":1607075072538},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1607075055352},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\vue-loader\\lib\\index.js","mtime":1607075069414}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.typed.uint8-array\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX from 'xlsx';\nexport default {\n  data: function data() {\n    var Uploadmessage = \"\";\n    return {\n      Uploadmessage: Uploadmessage\n    };\n  },\n  methods: {\n    handleUpload: function handleUpload(param) {\n      var _this = this;\n\n      var reader = new FileReader();\n\n      reader.onload = function (e) {\n        var data = new Uint8Array(e.target.result);\n        var workbook = XLSX.read(data, {\n          type: 'array'\n        });\n        var first_sheet_name = workbook.SheetNames[0];\n        var worksheet = workbook.Sheets[first_sheet_name];\n        var sheme = {\n          \"schemeName\": param.file.name.split('.xls')[0]\n        };\n        sheme.body = XLSX.utils.sheet_to_json(worksheet, {\n          header: 1\n        });\n        var reqUrl = 'http://122.9.97.197:8080';\n\n        _this.post(reqUrl + '/api/sendscheme', sheme).then(function (resp) {\n          if (resp.toString() == \"true\") {\n            _this.$store.commit('changeUpload');\n\n            _this.Uploadmessage = \"上传成功\";\n          } else {\n            _this.Uploadmessage = \"上传失败\";\n            console.log(resp);\n          }\n        }).catch(function (resp) {\n          console.log(resp);\n        });\n      };\n\n      reader.readAsArrayBuffer(param.file);\n    }\n  }\n};",{"version":3,"sources":["Mis.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,OAAA,IAAA,MAAA,MAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,QAAA,aAAA,GAAA,EAAA;AACA,WAAA;AACA,MAAA,aAAA,EAAA;AADA,KAAA;AAGA,GANA;AAOA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,KADA,EACA;AAAA;;AACA,UAAA,MAAA,GAAA,IAAA,UAAA,EAAA;;AACA,MAAA,MAAA,CAAA,MAAA,GAAA,UAAA,CAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,UAAA,CAAA,CAAA,CAAA,MAAA,CAAA,MAAA,CAAA;AACA,YAAA,QAAA,GAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,UAAA,IAAA,EAAA;AADA,SAAA,CAAA;AAGA,YAAA,gBAAA,GAAA,QAAA,CAAA,UAAA,CAAA,CAAA,CAAA;AACA,YAAA,SAAA,GAAA,QAAA,CAAA,MAAA,CAAA,gBAAA,CAAA;AACA,YAAA,KAAA,GAAA;AAAA,wBAAA,KAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,MAAA,EAAA,CAAA;AAAA,SAAA;AACA,QAAA,KAAA,CAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,aAAA,CAAA,SAAA,EAAA;AAAA,UAAA,MAAA,EAAA;AAAA,SAAA,CAAA;AACA,YAAA,MAAA,GAAA,0BAAA;;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,MAAA,GAAA,iBAAA,EAAA,KAAA,EAAA,IAAA,CAAA,UAAA,IAAA,EAAA;AACA,cAAA,IAAA,CAAA,QAAA,MAAA,MAAA,EAAA;AACA,YAAA,KAAA,CAAA,MAAA,CAAA,MAAA,CAAA,cAAA;;AACA,YAAA,KAAA,CAAA,aAAA,GAAA,MAAA;AACA,WAHA,MAGA;AACA,YAAA,KAAA,CAAA,aAAA,GAAA,MAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA;AACA,SARA,EAQA,KARA,CAQA,UAAA,IAAA,EAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,SAVA;AAWA,OArBA;;AAsBA,MAAA,MAAA,CAAA,iBAAA,CAAA,KAAA,CAAA,IAAA;AACA;AA1BA;AAPA,CAAA","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-upload\r\n\t\t  class=\"upload-demo\"\r\n\t\t  action=\"#\"\r\n\t\t  accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\r\n\t\t  :on-preview=\"handlePreview\"\r\n\t\t  :on-remove=\"handleRemove\"\r\n\t\t  :before-remove=\"beforeRemove\"\r\n\t\t  multiple\r\n\t\t  :limit=\"3\"\r\n\t\t  :on-exceed=\"handleExceed\"\r\n\t\t  :http-request=\"handleUpload\"\r\n\t\t  :file-list=\"fileList\">\r\n\t\t  <el-button size=\"small\" type=\"primary\">点击上传Excel方案</el-button>\r\n\t\t  <div slot=\"tip\" class=\"el-upload__tip\">只能上传xls/xlsx文件</div>\r\n\t\t</el-upload>\r\n\t\t{{Uploadmessage}}\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport XLSX from 'xlsx'\r\n\texport default {\r\n\t\tdata(){\r\n\t\t\tlet\tUploadmessage=\"\"\r\n\t\t\treturn {\r\n\t\t\t\tUploadmessage\r\n\t\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleUpload(param) {\r\n\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\treader.onload = (e)=> {\r\n\t\t\t\t\tvar data = new Uint8Array(e.target.result);\r\n\t\t\t\t\tvar workbook = XLSX.read(data, {\r\n\t\t\t\t\t\ttype: 'array'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar first_sheet_name = workbook.SheetNames[0];\r\n\t\t\t\t\tvar worksheet = workbook.Sheets[first_sheet_name];\r\n\t\t\t\t\tlet sheme={\"schemeName\":param.file.name.split('.xls')[0]};\t\t\t\t\t\r\n\t\t\t\t\tsheme.body=XLSX.utils.sheet_to_json(worksheet,{header:1});\r\n\t\t\t\t\tlet reqUrl='http://122.9.97.197:8080'\r\n\t\t\t\t\tthis.post(reqUrl+'/api/sendscheme',sheme).then(resp=>{\r\n\t\t\t\t\t\tif(resp.toString()==\"true\"){\r\n\t\t\t\t\t\t\tthis.$store.commit('changeUpload');\r\n\t\t\t\t\t\t\tthis.Uploadmessage=\"上传成功\";\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.Uploadmessage=\"上传失败\";\r\n\t\t\t\t\t\t\tconsole.log(resp)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  }).catch((resp)=>{\r\n\t\t\t\t\t  console.log(resp)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treader.readAsArrayBuffer(param.file)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\n"],"sourceRoot":"src/components"}]}