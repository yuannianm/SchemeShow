{"remainingRequest":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\src\\components\\Mis.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\src\\components\\Mis.vue","mtime":1607940281580},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\babel-loader\\lib\\index.js","mtime":1607075072538},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1607075055352},{"path":"C:\\Users\\Yuan\\OneDrive\\文档\\HBuilderProjects\\SchemeShow\\node_modules\\vue-loader\\lib\\index.js","mtime":1607075069414}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport XLSX from 'xlsx'\nexport default {\n\tdata(){\n\t\tlet\tUploadmessage=\"\"\n\t\treturn {\n\t\t\tUploadmessage\n\t\t\t}\n\t},\n\tmethods: {\n\t\thandleUpload(param) {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = (e)=> {\n\t\t\t\tvar data = new Uint8Array(e.target.result);\n\t\t\t\tvar workbook = XLSX.read(data, {\n\t\t\t\t\ttype: 'array'\n\t\t\t\t});\n\t\t\t\tvar first_sheet_name = workbook.SheetNames[0];\n\t\t\t\tvar worksheet = workbook.Sheets[first_sheet_name];\n\t\t\t\tlet sheme={\"schemeName\":param.file.name.split('.xls')[0]};\t\t\t\t\t\n\t\t\t\tsheme.body=XLSX.utils.sheet_to_json(worksheet,{header:1});\n\t\t\t\tlet reqUrl='http://122.9.97.197:8080'\n\t\t\t\tthis.post(reqUrl+'/api/sendscheme',sheme).then(resp=>{\n\t\t\t\t\tif(resp.toString()==\"true\"){\n\t\t\t\t\t\tthis.$store.commit('changeUpload');\n\t\t\t\t\t\tthis.Uploadmessage=\"上传成功\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.Uploadmessage=\"上传失败\";\n\t\t\t\t\t\tconsole.log(resp)\n\t\t\t\t\t}\n\t\t\t\t  }).catch((resp)=>{\n\t\t\t\t  console.log(resp)\n\t\t\t\t});\n\t\t\t}\n\t\t\treader.readAsArrayBuffer(param.file)\n\t\t}\n\t}\n}\n",{"version":3,"sources":["Mis.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Mis.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-upload\r\n\t\t  class=\"upload-demo\"\r\n\t\t  action=\"#\"\r\n\t\t  accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\r\n\t\t  :on-preview=\"handlePreview\"\r\n\t\t  :on-remove=\"handleRemove\"\r\n\t\t  :before-remove=\"beforeRemove\"\r\n\t\t  multiple\r\n\t\t  :limit=\"3\"\r\n\t\t  :on-exceed=\"handleExceed\"\r\n\t\t  :http-request=\"handleUpload\"\r\n\t\t  :file-list=\"fileList\">\r\n\t\t  <el-button size=\"small\" type=\"primary\">点击上传Excel方案</el-button>\r\n\t\t  <div slot=\"tip\" class=\"el-upload__tip\">只能上传xls/xlsx文件</div>\r\n\t\t</el-upload>\r\n\t\t{{Uploadmessage}}\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport XLSX from 'xlsx'\r\n\texport default {\r\n\t\tdata(){\r\n\t\t\tlet\tUploadmessage=\"\"\r\n\t\t\treturn {\r\n\t\t\t\tUploadmessage\r\n\t\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleUpload(param) {\r\n\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\treader.onload = (e)=> {\r\n\t\t\t\t\tvar data = new Uint8Array(e.target.result);\r\n\t\t\t\t\tvar workbook = XLSX.read(data, {\r\n\t\t\t\t\t\ttype: 'array'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar first_sheet_name = workbook.SheetNames[0];\r\n\t\t\t\t\tvar worksheet = workbook.Sheets[first_sheet_name];\r\n\t\t\t\t\tlet sheme={\"schemeName\":param.file.name.split('.xls')[0]};\t\t\t\t\t\r\n\t\t\t\t\tsheme.body=XLSX.utils.sheet_to_json(worksheet,{header:1});\r\n\t\t\t\t\tlet reqUrl='http://122.9.97.197:8080'\r\n\t\t\t\t\tthis.post(reqUrl+'/api/sendscheme',sheme).then(resp=>{\r\n\t\t\t\t\t\tif(resp.toString()==\"true\"){\r\n\t\t\t\t\t\t\tthis.$store.commit('changeUpload');\r\n\t\t\t\t\t\t\tthis.Uploadmessage=\"上传成功\";\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.Uploadmessage=\"上传失败\";\r\n\t\t\t\t\t\t\tconsole.log(resp)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  }).catch((resp)=>{\r\n\t\t\t\t\t  console.log(resp)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treader.readAsArrayBuffer(param.file)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\n"]}]}